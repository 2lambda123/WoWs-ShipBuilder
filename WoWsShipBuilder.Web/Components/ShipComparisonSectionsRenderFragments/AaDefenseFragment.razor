@using WoWsShipBuilder.ViewModels.Helper
@using WoWsShipBuilder.ViewModels.Other
@code {

    // Parameter needs to be named __builder, otherwise compilation will fail.
    // ReSharper disable once InconsistentNaming UnusedParameter.Local
    public static readonly RenderFragment<(ShipComparisonDataSections section, ILocalizer localizer)> AaDefenseDataFragment = element => __builder =>
    {
        bool hide = element.section != ShipComparisonDataSections.AntiAir;
        
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="LongAaRange" Title="Long Aura Range (km)" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.LongAaRange is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.LongAaRange
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>
        
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="LongAaConstantDamage" Title="Long aura DPS" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.LongAaConstantDamage is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.LongAaConstantDamage
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>
        
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="LongAaHitChance" Title="Long aura hit chance (%)" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.LongAaHitChance is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.LongAaHitChance
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>
        
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="Flak" Title="Flaks" HeaderClass="column-text-center" CellClass="column-text-center" SortBy="@(x => int.Parse(x.Flak?.Split(" ± ").First() ?? "0"))">
            <CellTemplate>
                @if (!string.IsNullOrEmpty(context.Item.Flak))
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.Flak
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>
        
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="FlakDamage" Title="Flaks damage" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.FlakDamage is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.FlakDamage
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>
        
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MediumAaRange" Title="Medium aura range (km)" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.MediumAaRange is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.MediumAaRange
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>
        
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MediumAaConstantDamage" Title="Medium aura DPS" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.MediumAaConstantDamage is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.MediumAaConstantDamage
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>
        
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MediumAaHitChance" Title="Medium aura hit chance (%)" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.MediumAaHitChance is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.MediumAaHitChance
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>

        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="ShortAaRange" Title="Short aura range (km)" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.ShortAaRange is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.ShortAaRange
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>

        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="ShortAaConstantDamage" Title="Short aura DPS" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.ShortAaConstantDamage is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.ShortAaConstantDamage
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>
        
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="ShortAaHitChance" Title="Short aura hit chance (%)" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.ShortAaHitChance is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.ShortAaHitChance
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </Column>
    };
}