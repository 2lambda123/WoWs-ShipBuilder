@using WoWsShipBuilder.ViewModels.Helper
@using WoWsShipBuilder.ViewModels.Other
@using System.Globalization
@code {

    // Parameter needs to be named __builder, otherwise compilation will fail.
    // ReSharper disable once InconsistentNaming UnusedParameter.Local
    public static readonly RenderFragment<(ShipComparisonViewModel.DataSections section, ILocalizer localizer)> MainBatteryDataFragment = element => __builder =>
    {
        bool hide = element.section != ShipComparisonViewModel.DataSections.MainBattery;
        NumberFormatInfo nfi = default!;
        if (!hide)
        {
            nfi = (NumberFormatInfo)CultureInfo.InvariantCulture.NumberFormat.Clone();
            nfi.NumberGroupSeparator = "'";
        }
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryCaliber" Title="Caliber (mm)" SortBy="@(x => x.ShipDataContainer.MainBatteryDataContainer?.GunCaliber ?? 0)"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryBarrelCount" Title="Barrels" SortBy="@(x => x.ShipDataContainer.MainBatteryDataContainer?.BarrelsCount ?? 0)"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryRange" Title="Range (km)" SortBy="@(x => x.ShipDataContainer.MainBatteryDataContainer?.Range ?? 0)"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryTurnTime" Title="180° turn time (s)" SortBy="@(x => x.ShipDataContainer.MainBatteryDataContainer?.TurnTime ?? 0)"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryTraverseSpeed" Title="Traverse speed (°/s)" SortBy="@(x => x.ShipDataContainer.MainBatteryDataContainer?.TraverseSpeed ?? 0)"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryReload" Title="Reload (s)" SortBy="@(x => x.ShipDataContainer.MainBatteryDataContainer?.Reload ?? 0)"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryRoF" Title="RoF (shots/min)" SortBy="@(x => x.ShipDataContainer.MainBatteryDataContainer?.RoF ?? 0)"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryHeDpm" Title="HE DPM" SortBy="@(x => int.Parse(x.ShipDataContainer.MainBatteryDataContainer?.TheoreticalHeDpm ?? "0", NumberStyles.AllowThousands, nfi))"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryApDpm" Title="AP DPM" SortBy="@(x => int.Parse(x.ShipDataContainer.MainBatteryDataContainer?.TheoreticalApDpm ?? "0", NumberStyles.AllowThousands, nfi))"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatterySapDpm" Title="SAP DPM" SortBy="@(x => int.Parse(x.ShipDataContainer.MainBatteryDataContainer?.TheoreticalSapDpm ?? "0", NumberStyles.AllowThousands, nfi))"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryHeSalvo" Title="HE Salvo" SortBy="@(x => int.Parse(x.ShipDataContainer.MainBatteryDataContainer?.HeSalvo ?? "0", NumberStyles.AllowThousands, nfi))"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryApSalvo" Title="AP Salvo" SortBy="@(x => int.Parse(x.ShipDataContainer.MainBatteryDataContainer?.ApSalvo ?? "0", NumberStyles.AllowThousands, nfi))"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatterySapSalvo" Title="SAP Salvo" SortBy="@(x => int.Parse(x.ShipDataContainer.MainBatteryDataContainer?.SapSalvo ?? "0", NumberStyles.AllowThousands, nfi))"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatteryFpm" Title="FPM (fires/min)" SortBy="@(x => x.ShipDataContainer.MainBatteryDataContainer?.PotentialFpm ?? 0)"/>
        <Column Hidden="hide" T="ShipComparisonDataWrapper" Field="MainBatterySigma" Title="Sigma" SortBy="@(x => x.ShipDataContainer.MainBatteryDataContainer?.Sigma ?? 0)"/>
    };
}